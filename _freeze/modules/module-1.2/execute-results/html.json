{
  "hash": "1a287dc3e12506db86af1f2295dbf395",
  "result": {
    "markdown": "---\ntitle: \"Module 1.2\"\nsubtitle: \"Working With APIs\"\nformat: html\nhighlight-style: atom-one\nexecute: \n  echo: true\n  message: false\n  warning: false\n---\n\n\n::: {.callout-tip}\n## Prework\n\n- Install the devtools package. Type `install.packages(\"devtools\")` in your console. You will need this to install the `vdemdata` package becaue it is not on the CRAN Network. \n\n- Install the `vdemdata` package from GitHub. Type `devtools::install_github(\"vdeminstitute/vdemdata\")` in your console. \n\n- Install the `wbstats` and `countrycode` packages:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npkg_list <- c(\"wbstats\", \"countrycode\")\n\ninstall.packages(pkg_list)\n```\n:::\n\n\n- Generate a quarto document named \"module-1.2.qmd\" in your modules project folder so that you can code along with me\n:::\n\n## Overview \n\n\n## Wrangle WB data\n\nPicking up where we left off... but let's add one more variable...and use lubridate to specify the most recent date. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(wbstats) \nlibrary(dplyr)\nlibrary(janitor)\n\nindicators <- c(flfp = \"SL.TLF.CACT.FE.ZS\", women_rep = \"SG.GEN.PARL.ZS\")\n\nwomen_emp <- wb_data(indicators, mrv = 50) |> \n  select(!iso2c) |> \n  rename(year = date) |> \n    mutate(\n    flfp = round_to_fraction(flfp, denominator = 100), \n    women_rep = round_to_fraction(women_rep, denominator = 100)\n  )\n\nglimpse(women_emp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 6,944\nColumns: 5\n$ iso3c     <chr> \"ABW\", \"ABW\", \"ABW\", \"ABW\", \"ABW\", \"ABW\", \"ABW\", \"ABW\", \"ABW…\n$ country   <chr> \"Aruba\", \"Aruba\", \"Aruba\", \"Aruba\", \"Aruba\", \"Aruba\", \"Aruba…\n$ year      <dbl> 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, …\n$ women_rep <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ flfp      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n```\n:::\n:::\n\n\n## Filter observations, select and create new variables \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vdemdata)\nlibrary(tibble)\n\ndemocracy <- vdem |> \n  filter(year >= 1974)  |> \n  select(\n    country = country_name,\n    vdem_ctry_id = country_id, \n    year, \n    polyarchy = v2x_polyarchy, \n    gdp_pc = e_gdppc, \n    region = e_regionpol_6C\n    ) |>\n    mutate(\n    region = recode(region, `1` = \"Eastern Europe\", \n                    `2` = \"Latin America\", \n                    `3` = \"Middle East\", \n                    `4` = \"Africa\", \n                    `5` = \"The West\", \n                    `6` = \"Asia\")\n  ) |> \n  as_tibble()\n\nglimpse(democracy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 8,182\nColumns: 6\n$ country      <chr> \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico…\n$ vdem_ctry_id <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, …\n$ year         <dbl> 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 198…\n$ polyarchy    <dbl> 0.252, 0.252, 0.259, 0.274, 0.297, 0.298, 0.302, 0.304, 0…\n$ gdp_pc       <dbl> 9.189, 9.480, 9.673, 9.914, 10.434, 11.146, 11.865, 12.32…\n$ region       <chr> \"Latin America\", \"Latin America\", \"Latin America\", \"Latin…\n```\n:::\n:::\n\n## Add country code to democracy tibble\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(countrycode)\n\ndemocracy <- democracy |> \n  mutate(iso3c = countrycode(vdem_ctry_id, \"vdem\", \"wb\"))  |> \n  relocate(iso3c, .after = vdem_ctry_id)\n\nglimpse(democracy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 8,182\nColumns: 7\n$ country      <chr> \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico…\n$ vdem_ctry_id <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, …\n$ iso3c        <chr> \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"…\n$ year         <dbl> 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 198…\n$ polyarchy    <dbl> 0.252, 0.252, 0.259, 0.274, 0.297, 0.298, 0.302, 0.304, 0…\n$ gdp_pc       <dbl> 9.189, 9.480, 9.673, 9.914, 10.434, 11.146, 11.865, 12.32…\n$ region       <chr> \"Latin America\", \"Latin America\", \"Latin America\", \"Latin…\n```\n:::\n\n```{.r .cell-code}\n#filter(democracy, is.na(iso3c))\n```\n:::\n\n\n## Merge two datasets \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\n\ndem_women <- left_join(democracy, women_emp, by = c(\"iso3c\", \"year\")) |> \n  rename(country = country.x) |> \n  select(!country.y)\n\nglimpse(dem_women)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 8,182\nColumns: 9\n$ country      <chr> \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico\", \"Mexico…\n$ vdem_ctry_id <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, …\n$ iso3c        <chr> \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"MEX\", \"…\n$ year         <dbl> 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 198…\n$ polyarchy    <dbl> 0.252, 0.252, 0.259, 0.274, 0.297, 0.298, 0.302, 0.304, 0…\n$ gdp_pc       <dbl> 9.189, 9.480, 9.673, 9.914, 10.434, 11.146, 11.865, 12.32…\n$ region       <chr> \"Latin America\", \"Latin America\", \"Latin America\", \"Latin…\n$ women_rep    <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ flfp         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n```\n:::\n\n```{.r .cell-code}\nwrite_csv(dem_women, \"dem_women.csv\")\n```\n:::\n\n\n## Group, summarize and arrange (summarize by region)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndem_summary <- dem_women |> \n  group_by(region)  |> \n  summarize(\n    polyarchy = mean(polyarchy, na.rm = TRUE),\n    gdp_pc = mean(gdp_pc, na.rm = TRUE), \n    flfp = mean(flfp, na.rm = TRUE), \n    women_rep = mean(women_rep, na.rm = TRUE)\n  ) |> \n  arrange(desc(polyarchy)) \n\ndem_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  region         polyarchy gdp_pc  flfp women_rep\n  <chr>              <dbl>  <dbl> <dbl>     <dbl>\n1 The West           0.857  32.7   52.8     27.8 \n2 Latin America      0.550   8.59  48.0     20.9 \n3 Eastern Europe     0.484  11.8   51.4     17.6 \n4 Asia               0.362   7.78  50.3     14.3 \n5 Africa             0.325   3.92  56.7     17.2 \n6 Middle East        0.219  20.7   26.5      9.95\n```\n:::\n\n```{.r .cell-code}\n#filter(dem_women, is.na(region))\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}